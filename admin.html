<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Vrijeplek — Admin</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root{--ink:#0f172a;--muted:#64748b;--blue:#0ea5e9;--bg:#f7fbff}
    *{box-sizing:border-box}html,body{margin:0}
    body{font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:var(--bg);color:var(--ink)}
    .container{max-width:980px;margin:0 auto;padding:20px}
    .card{background:#fff;border:1px solid #e6eef6;border-radius:16px;box-shadow:0 10px 22px rgba(2,6,23,.06);padding:16px}
    h1{font-size:22px;margin:0 0 12px}
    h2{font-size:16px;margin:0 0 8px}
    .muted{color:var(--muted)}
    .grid{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:12px}
    .row{display:flex;gap:10px;align-items:center}
    label{min-width:210px}
    input[type="number"],input[type="text"],select{height:40px;border:1px solid #dbe7f3;border-radius:10px;padding:0 10px;width:100%}
    .btn{height:42px;padding:0 16px;border-radius:10px;border:1px solid var(--blue);background:var(--blue);color:#fff;font-weight:600;cursor:pointer}
    .btn.secondary{background:#fff;color:#0e7490}
    .right{display:flex;gap:8px;justify-content:flex-end}
    .out{white-space:pre-wrap;background:#f8fbff;border:1px dashed #d9e9f6;border-radius:12px;padding:12px}
    .login{max-width:380px;margin:14vh auto 0}
    .tac{text-align:center}
    .hide{display:none}
    .badge{display:inline-block;padding:4px 8px;border-radius:999px;border:1px solid #e6eef6}
    @media (max-width:800px){.grid{grid-template-columns:1fr} label{min-width:160px}}
  </style>
</head>
<body>
  <div class="container">
    <!-- Login -->
    <div id="login" class="card login">
      <h1>Admin inloggen</h1>
      <p class="muted">Voer je wachtwoord in om de admin te openen.</p>
      <div class="row">
        <label for="pw">Wachtwoord</label>
        <input id="pw" type="password" placeholder="••••••••••" autocomplete="current-password" />
      </div>
      <div class="right" style="margin-top:10px">
        <button class="btn" id="btnLogin">Inloggen</button>
      </div>
      <p id="err" class="muted" style="margin-top:8px;color:#b91c1c"></p>
    </div>

    <!-- App -->
    <div id="app" class="hide">
      <div class="card" style="margin-bottom:12px">
        <div style="display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap">
          <h1>Vrijeplek — Admin</h1>
          <div class="row">
            <span class="badge" id="badgePlan">Plan: —</span>
            <button class="btn secondary" id="btnLogout">Uitloggen</button>
          </div>
        </div>
      </div>

      <!-- Credits calculator -->
      <div class="card">
        <h2>Netlify credits calculator</h2>
        <p class="muted">Vul je schatting in per maand.</p>
        <div class="grid" style="margin-top:8px">
          <div class="row"><label for="plan">Plan</label>
            <select id="plan">
              <option value="free">Free (300 credits)</option>
              <option value="personal" selected>Personal (1.000 credits)</option>
              <option value="pro">Pro (3.000 credits)</option>
            </select>
          </div>

          <div class="row"><label for="req">Web requests (per maand)</label>
            <input id="req" type="number" min="0" step="1000" value="20000">
          </div>

          <div class="row"><label for="bw">Bandbreedte (GB/maand)</label>
            <input id="bw" type="number" min="0" step="1" value="30">
          </div>

          <div class="row"><label for="deploys">Production deploys</label>
            <input id="deploys" type="number" min="0" step="1" value="4">
          </div>

          <div class="row"><label for="forms">Form submissions</label>
            <input id="forms" type="number" min="0" step="1" value="0">
          </div>

          <div class="row"><label for="compute">Compute (GB-uur functies)</label>
            <input id="compute" type="number" min="0" step="0.1" value="0">
          </div>
        </div>

        <div class="right" style="margin-top:10px">
          <button class="btn" id="btnCalc">Bereken</button>
        </div>

        <div id="out" class="out" style="margin-top:12px"></div>
      </div>
    </div>
  </div>

  <script>
    // ==== simpele client-side login (SHA-256) ====
    const HASH = "505e91f33fcbb16d57f0d3aa0841dfcf6cff88ebb5a6aed24605f1d7bfde3f38"; // sha256("Azerty3600!")
    const TOKKEY = "vp_admin_token";

    const $ = (id)=>document.getElementById(id);
    const loginBox = $("login"), appBox = $("app"), err = $("err");

    async function sha256(txt){
      const enc = new TextEncoder().encode(txt);
      const buf = await crypto.subtle.digest("SHA-256", enc);
      return [...new Uint8Array(buf)].map(b=>b.toString(16).padStart(2,"0")).join("");
    }
    function showApp(){
      loginBox.classList.add("hide");
      appBox.classList.remove("hide");
    }
    function logout(){
      localStorage.removeItem(TOKKEY);
      location.reload();
    }
    $("btnLogout").addEventListener("click", logout);

    $("btnLogin").addEventListener("click", async ()=>{
      err.textContent = "";
      const pw = $("pw").value || "";
      const h = await sha256(pw);
      if(h === HASH){
        localStorage.setItem(TOKKEY, JSON.stringify({ ok:true, t:Date.now() }));
        showApp();
      } else {
        err.textContent = "Onjuist wachtwoord.";
      }
    });

    // Auto-login als token bestaat (24u geldig)
    try{
      const tok = JSON.parse(localStorage.getItem(TOKKEY) || "null");
      if(tok && tok.ok && (Date.now() - tok.t) < 24*60*60*1000){ showApp(); }
    }catch{}

    // ==== credits calculator ====
    // rates (bron: Netlify pricing/docs, okt 2025)
    // Production deploy: 15 credits; Bandwidth: 10 credits/GB;
    // Web requests: 3 credits per 10k; Forms: 1 credit; Compute: 5 credits/GB-uur.
    const RATES = { DEPLOY:15, BW_PER_GB:10, REQ_PER_10K:3, FORM:1, COMPUTE_GBHR:5 };
    const PLAN_CREDITS = { free:300, personal:1000, pro:3000 };

    function calc(){
      const plan = $("plan").value;
      $("badgePlan").textContent = `Plan: ${plan.toUpperCase()} (${PLAN_CREDITS[plan].toLocaleString()} credits)`;

      const req = +$("req").value||0;
      const bw = +$("bw").value||0;
      const dep = +$("deploys").value||0;
      const forms = +$("forms").value||0;
      const comp = +$("compute").value||0;

      const creditsReq = Math.ceil(req/10000)*RATES.REQ_PER_10K;
      const creditsBw  = bw * RATES.BW_PER_GB;
      const creditsDep = dep * RATES.DEPLOY;
      const creditsFrm = forms * RATES.FORM;
      const creditsCmp = comp * RATES.COMPUTE_GBHR;

      const total = Math.ceil(creditsReq + creditsBw + creditsDep + creditsFrm + creditsCmp);
      const included = PLAN_CREDITS[plan];
      const short = Math.max(0, total - included);

      // Add-on pakketten (per officiële pagina)
      // Personal: $5/500 credits. Pro: $10/1,500 credits. Free: geen auto-recharge.
      let refillText = "—";
      if(plan === "personal"){
        const packs = Math.ceil(short/500);
        if(short>0) refillText = `$${(packs*5).toFixed(2)} voor ${packs*500} extra credits`;
      } else if(plan === "pro"){
        const packs = Math.ceil(short/1500);
        if(short>0) refillText = `$${(packs*10).toFixed(2)} voor ${packs*1500} extra credits`;
      } else {
        if(short>0) refillText = `Upgrade nodig (Free heeft harde limiet).`;
      }

      $("out").textContent =
        `Verbruik (credits/maand):
- Web requests: ${creditsReq}
- Bandbreedte:  ${creditsBw}
- Deploys:      ${creditsDep}
- Forms:        ${creditsFrm}
- Compute:      ${creditsCmp}
= Totaal:       ${total}

Plan inbegrepen: ${included}
Tekort:          ${short}

Extra credits (inschatting):
${refillText}
`;
    }

    $("btnCalc").addEventListener("click", calc);
    calc(); // initiale run
  </script>
</body>
</html>
