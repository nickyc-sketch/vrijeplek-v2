<!DOCTYPE html>
<html lang="nl">
<head>
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Vrijeplek ‚Äî Maak je bedrijfsprofiel</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
  <style>
    /* Basis */
    *, *::before, *::after { box-sizing: border-box; }
    html, body { margin:0; padding:0; font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; color:#0f172a; }

    /* Hero */
    .page-hero{padding:44px 0;background:linear-gradient(180deg,#e8f4ff,#f7fbff)}
    .page-hero h1{margin:0;text-align:center}
    .page-hero p{margin:8px 0 0;text-align:center;color:#64748b}

    /* Layout */
    .wrap{max-width:1080px;margin:0 auto;padding:0 20px}
    .cards{
      display:grid;grid-template-columns:1.2fr .8fr;gap:16px;
      /* Z√©√©r belangrijk voor overflow in grid-items */
      align-items:start;
    }
    .card{
      background:#fff;border:1px solid #e8eff7;border-radius:16px;
      box-shadow:0 8px 22px rgba(2,6,23,.06);padding:16px;
      min-width:0; /* voorkomt uitduwen in grid */
    }
    .card h2,.card h3{margin:0 0 10px}

    /* Specs */
    .spec-grid{
      display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:12px
    }
    .spec{
      display:flex;gap:12px;align-items:flex-start;background:#fff;
      border:1px solid #e8eff7;border-radius:14px;padding:14px;min-width:0;
    }
    .spec-ico{
      flex:0 0 42px;height:42px;display:grid;place-items:center;border-radius:12px;
      background:#f1f9ff;font-size:18px;color:#0e7490
    }
    .spec-title{font-weight:700;line-height:1.25;word-break:break-word}
    .spec-sub{color:#64748b;font-size:14px;margin-top:2px;line-height:1.35;word-break:break-word;overflow-wrap:anywhere}

    .pill{display:inline-block;margin-left:8px;padding:3px 8px;border-radius:999px;border:1px solid transparent;font-size:12px;vertical-align:middle}
    .pill-req{color:#0b6c98;border-color:#0b6c981a;background:#e6f4fb}
    .pill-opt{color:#64748b;border-color:#64748b1a;background:#f4f6f8}

    /* Steps */
    .steps{display:grid;grid-template-columns:repeat(4,minmax(0,1fr));gap:12px}
    .step{
      display:flex;gap:10px;align-items:flex-start;background:#fff;border:1px solid #e8eff7;
      border-radius:14px;padding:14px;min-width:0;
    }
    .step-num{flex:0 0 28px;height:28px;display:grid;place-items:center;border-radius:999px;background:#0ea5e9;color:#fff;font-weight:700}
    .step-title{font-weight:700;line-height:1.25;word-break:break-word}
    .step-sub{color:#64748b;font-size:14px;line-height:1.35;overflow-wrap:anywhere;word-break:break-word}

    /* Stats */
    .stats{display:flex;gap:14px;align-items:center;flex-wrap:wrap}
    .stats .num{font-size:34px;font-weight:700;line-height:1}
    .muted{color:#64748b}

    /* CTA */
    .cta-band{background:linear-gradient(90deg,#e8f6ff,#eefaff);border-top:1px solid #e6eef6;border-bottom:1px solid #e6eef6}
    .cta-inner{display:flex;gap:16px;align-items:center;justify-content:space-between;flex-wrap:wrap;padding:18px 0}
    .btn-lg{height:48px;padding:0 20px;border-radius:14px;font-weight:700}

    /* Form */
    .form{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .form .row{display:flex;flex-direction:column;gap:6px;min-width:0}
    .form label{font-size:14px;color:#334155}
    .form input,.form textarea,.form select{
      height:44px;padding:0 12px;border:1px solid #dbe7f3;border-radius:12px;background:#fff;font-size:14px;min-width:0
    }
    .form textarea{height:96px;padding:10px 12px;resize:vertical}
    .form .full{grid-column:1/-1}
    .form .btn{height:46px;border-radius:12px}

    /* Responsive tweaks (incl. jouw losse CSS die onderaan stond) */
    @media (max-width:1200px){ .cards{grid-template-columns:1fr 1fr} }
    @media (max-width:1000px){
      .cards{grid-template-columns:1fr}
      .steps{grid-template-columns:1fr 1fr}
    }
    @media (max-width:680px){
      .spec-grid{grid-template-columns:1fr}
      .steps{grid-template-columns:1fr}
      .form{grid-template-columns:1fr}
    }
  </style>
</head>
<body>
  <header class="site-header">
    <div class="container header-inner">
      <a href="index.html" class="brand" style="text-decoration:none;">
        <span class="brand-name">Vrijeplek</span><span class="brand-dot"></span>
      </a>
      <nav class="header-actions">
        <a class="admin-link" href="/admin.html" style="display:none">Admin</a>
      </nav>
    </div>
  </header>

  <main>
    <section class="page-hero">
      <div class="wrap">
        <h1>Maak je bedrijfsprofiel</h1>
        <p>Vul lege momenten vandaag nog met boekingen uit je buurt.</p>
      </div>
    </section>

    <section class="section section--ocean">
  <div class="wrap cards">
     
          <h2>Wat tonen we op je profiel</h2>
          <div class="spec-grid">
            <div class="spec"><div class="spec-ico">üè∑Ô∏è</div><div><div class="spec-title">Naam &amp; categorie <span class="pill pill-req">verplicht</span></div><div class="spec-sub">bv. ‚ÄúSalon Luna‚Äù ‚Äî Kapsalon</div></div></div>
            <div class="spec"><div class="spec-ico">üìç</div><div><div class="spec-title">Locatie <span class="pill pill-req">verplicht</span></div><div class="spec-sub">adres + kaartpin voor ‚Äúin de buurt‚Äù</div></div></div>
            <div class="spec"><div class="spec-ico">üßæ</div><div><div class="spec-title">BTW-nummer <span class="pill pill-req">verplicht</span></div><div class="spec-sub">verificatie van je bedrijf</div></div></div>
            <div class="spec"><div class="spec-ico">‚òéÔ∏è</div><div><div class="spec-title">Contact <span class="pill pill-req">verplicht</span></div><div class="spec-sub">telefoon en/of website</div></div></div>
            <div class="spec"><div class="spec-ico">üñºÔ∏è</div><div><div class="spec-title">Logo <span class="pill pill-opt">optioneel</span></div><div class="spec-sub">PNG/JPG 512√ó512 aangeraden</div></div></div>
            <div class="spec"><div class="spec-ico">‚úçÔ∏è</div><div><div class="spec-title">Korte intro <span class="pill pill-opt">optioneel</span></div><div class="spec-sub">√©√©n zin waarom klanten jou kiezen</div></div></div>
            <div class="spec"><div class="spec-ico">‚è∞</div><div><div class="spec-title">Openingsuren <span class="pill pill-opt">optioneel</span></div><div class="spec-sub">toon je standaarduren</div></div></div>
            <div class="spec"><div class="spec-ico">‚ö°</div><div><div class="spec-title">Last-minute tijdsloten <span class="pill pill-opt">wanneer jij wil</span></div><div class="spec-sub">publiceer lege momenten met √©√©n klik</div></div></div>
          </div>
        </div>

        <div class="card">
          <h3>Zo werken tijdsloten</h3>
          <div class="steps" style="margin-top:6px">
            <div class="step"><span class="step-num">1</span><div><div class="step-title">Kies lege momenten</div><div class="step-sub">vandaag 14:30‚Äì16:00, morgen 10:00‚Äì12:00</div></div></div>
            <div class="step"><span class="step-num">2</span><div><div class="step-title">Koppel een dienst</div><div class="step-sub">knippen, massage, consult, lunch‚Ä¶</div></div></div>
            <div class="step"><span class="step-num">3</span><div><div class="step-title">Publiceer</div><div class="step-sub">verschijnt direct bij ‚ÄúZaken in de buurt‚Äù</div></div></div>
            <div class="step"><span class="step-num">4</span><div><div class="step-title">Krijg boekingen</div><div class="step-sub">bevestiging per e-mail</div></div></div>
          </div>
          <div class="stats" style="margin-top:12px">
            <div class="num">+12%</div>
            <div class="muted">extra omzet (typisch bereik <strong>+8‚Äì18%</strong>) door lege uren te vullen</div>
          </div>
        </div>
      </div>
    </section>

    <section class="cta-band">
      <div class="wrap cta-inner">
        <div>
          <div style="font-weight:700">Klaar om te starten?</div>
          <div class="muted">Eenvoudig tarief: <strong>‚Ç¨9/maand</strong>. Pauzeren of aanpassen kan wanneer je wil.</div>
        </div>
        <a class="btn btn-lg btn-primary" href="#signup">Start je profiel</a>
      </div>
    </section>

    <section class="section" id="signup">
      <div class="wrap card">
        <h2>Meld je bedrijf aan</h2>
        <p class="muted" style="margin:6px 0 12px">Vul je gegevens in. Je kunt later altijd aanpassen of pauzeren.</p>

        <!-- status/feedback -->
        <p id="msg" class="muted" style="margin:0 0 10px"></p>

        <!-- Belangrijk: id toegevoegd en inline onsubmit verwijderd -->
        <form id="signupForm" class="form">
          <div class="row"><label for="company">Bedrijfsnaam *</label><input id="company" name="company" required></div>
          <div class="row"><label for="vat">BTW-nummer *</label><input id="vat" name="vat" required></div>
          <div class="row"><label for="category">Categorie *</label>
            <select id="category" name="category" required>
              <option value="">Kies een categorie</option>
              <option>Horeca</option><option>Wellness & Beauty</option><option>Gezondheidszorg</option>
              <option>Events & verhuur</option><option>Interieurverzorging</option><option>Poetsdiensten</option><option>Ramenwassers</option>
            </select>
          </div>
          <div class="row"><label for="address">Adres *</label><input id="address" name="address" required></div>
          <div class="row"><label for="email">E-mail *</label><input id="email" name="email" type="email" required></div>
          <div class="row"><label for="phone">Telefoon</label><input id="phone" name="phone" type="tel"></div>
          <div class="row full"><label for="intro">Korte intro (optioneel)</label><textarea id="intro" name="intro" maxlength="160"></textarea></div>
          <div class="row"><label for="logo">Logo (optioneel)</label><input id="logo" name="logo" type="file" accept="image/*"></div>
          <div class="row"><label for="hours">Openingsuren (optioneel)</label><input id="hours" name="hours" placeholder="bv. Ma‚ÄìVr 9‚Äì18u"></div>
          <div class="row full"><button class="btn btn-lg btn-primary" type="submit">Aanmelden</button></div>
        </form>
      </div>
    </section>
  </main>

  <script>
  async function getToken(){
    let u = netlifyIdentity.currentUser();
    if(!u){
      netlifyIdentity.open("login");
      await new Promise(r => netlifyIdentity.on("login", ()=>r()));
      u = netlifyIdentity.currentUser();
      netlifyIdentity.close();
    }
    return await u.jwt();
  }

  async function uploadLogo(file, token){
    if(!file) return "";
    const sig = await fetch("/.netlify/functions/cloudinary-sign", {
      method:"POST", headers:{ "Authorization":"Bearer "+token }
    }).then(r=>r.json());
    const fd = new FormData();
    fd.append("file", file);
    fd.append("api_key", sig.api_key);
    fd.append("timestamp", sig.timestamp);
    fd.append("signature", sig.signature);
    fd.append("folder", sig.folder);
    const res = await fetch(`https://api.cloudinary.com/v1_1/${sig.cloud_name}/image/upload`, { method:"POST", body:fd }).then(r=>r.json());
    return res.secure_url || "";
  }

  // Belangrijk: luister op het juiste formulier-id
  document.getElementById("signupForm").addEventListener("submit", async (e)=>{
    e.preventDefault();
    const f=e.target;
    const payload={
      name:f.company.value.trim(),
      vat:f.vat.value.trim(),
      category:f.category.value,
      address:f.address.value.trim(),
      email:f.email.value.trim(),
      phone:f.phone.value.trim(),
      intro:f.intro.value.trim()
    };
    try{
      document.getElementById("msg").textContent="Even geduld‚Ä¶ aanmelden wordt verwerkt.";
      const token = await getToken();
      const logoFile = document.getElementById("logo").files[0];
      const logo_url = await uploadLogo(logoFile, token);
      payload.logo_url = logo_url;

      const res = await fetch("/.netlify/functions/business-create",{
        method:"POST",
        headers:{ "content-type":"application/json", "Authorization":"Bearer "+token },
        body: JSON.stringify(payload)
      }).then(r=>r.json());

      if(!res.ok) throw new Error("create_failed");
      location.href="/dashboard.html";
    }catch(err){
      document.getElementById("msg").textContent="Kon niet aanmelden. Probeer opnieuw.";
    }
  });
  </script>
</body>
</html>
.section--ocean {
  background: linear-gradient(180deg, #eaf6ff 0%, #f5fbff 100%);
  border-top: 1px solid #e6eef6;
  border-bottom: 1px solid #e6eef6;
  padding: 28px 0;
}
.cards { gap: 20px; }
.card { min-width: 0; padding: 20px; border-radius: 16px; }
.card > * { min-width: 0; }
.card h2, .card h3 { margin: 0 0 12px; line-height: 1.2; }
.spec-grid { gap: 14px; }
.spec { min-width: 0; padding: 16px; border-radius: 14px; }
.spec-ico {
  flex: 0 0 48px; height: 48px; border-radius: 14px;
  font-size: 20px; background:#eef7ff; color:#0e7490;
}
.spec-title { font-weight: 700; line-height: 1.3; word-break: break-word; }
.spec-sub   { color:#64748b; font-size:14px; line-height:1.4; overflow-wrap:anywhere; word-break: break-word; }

/* Pills duidelijker */
.pill { padding: 4px 10px; border-radius: 999px; font-size: 12px; }
.pill-req { color:#0b6c98; border-color:#0b6c981a; background:#e6f4fb; }
.pill-opt { color:#64748b; border-color:#64748b1a; background:#f4f6f8; }
.steps { gap: 14px; }
.step { min-width: 0; padding: 16px; border-radius: 14px; }
.step-title { font-weight: 700; line-height: 1.3; word-break: break-word; }
.step-sub   { color:#64748b; font-size:14px; line-height:1.4; overflow-wrap:anywhere; word-break: break-word; }
.stats { gap: 16px; flex-wrap: wrap; }
.stats .num { font-size: 36px; }
.form .row { min-width: 0; }
.form input, .form textarea, .form select {
  min-width: 0;
  border: 1px solid #dbe7f3;
  border-radius: 12px;
  background: #fff;
  transition: border-color .15s ease, box-shadow .15s ease;
}
.form input:focus, .form textarea:focus, .form select:focus {
  outline: none;
  border-color: #0ea5e9;
  box-shadow: 0 0 0 3px rgba(14,165,233,.15);
}
@media (max-width: 1200px) {
  .cards { grid-template-columns: 1fr 1fr; }
}
@media (max-width: 1000px) {
  .cards { grid-template-columns: 1fr; }
  .steps { grid-template-columns: 1fr 1fr; }
}
@media (max-width: 680px) {
  .spec-grid { grid-template-columns: 1fr; }
  .steps     { grid-template-columns: 1fr; }
  .form      { grid-template-columns: 1fr; }
}
